define(["text!scripts/upfront/settings/modules/menu-structure/menu-item-editor.tpl"],function(e){var t=function(){var e=[];return _.each(Upfront.data.ugallery.postTypes,function(t){t.name!="attachment"&&e.push({name:t.name,label:t.label})}),e},n=Backbone.View.extend({className:"menu-item-editor",events:{"click .menu-item-entry-input":"showPagePostSelector"},initialize:function(e){this.options=e||{}},render:function(){return this.$el.html(_.template(e,{title:this.model.get("menu-item-title"),type:Upfront.Util.guessLinkType(this.model.get("menu-item-url")),url:this.model.get("menu-item-url")})),this.renderTypeSelect(),this},renderTypeSelect:function(){var e=this,t=[];_.each(["external","entry","anchor","lightbox","email"],function(e){t.push(this.getLinkTypeValue(e))},this),this.typeSelect=new Upfront.Views.Editor.Field.Select({label:"",values:t,default_value:Upfront.Util.guessLinkType(this.model.get("menu-item-url")),change:function(t){e.onTypeChange(t)}}),this.typeSelect.render(),this.$el.find(".item-links-to-label").after(this.typeSelect.el)},onTypeChange:function(e){console.log("select value changed",e)},getLinkTypeValue:function(e){var t=Upfront.Settings.l10n.global.content;switch(e){case"unlink":return{value:"unlink",label:t.no_link};case"external":return{value:"external",label:t.url};case"email":return{value:"email",label:"Email address"};case"entry":return{value:"entry",label:t.post_or_page};case"anchor":return{value:"anchor",label:t.anchor};case"image":return{value:"image",label:t.larger_image};case"lightbox":return{value:"lightbox",label:t.lightbox}}},showPagePostSelector:function(e){e&&e.preventDefault();var n=this,r={postTypes:t()};Upfront.Views.Editor.PostSelector.open(r).done(function(e){n.model.set({"menu-item-url":e.get("permalink")}),Upfront.Util.post({action:"upfront_update_single_menu_item",menuId:n.options.menuId,menuItemData:n.model.toJSON()}),n.render()})}});return n});