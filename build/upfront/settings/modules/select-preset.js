define(["scripts/upfront/settings/modules/base-module","scripts/upfront/settings/fields/select-preset"],function(e,t){var n=Upfront.Settings.l10n.preset_manager,r=e.extend({className:"select-presets",initialize:function(e){this.options=e||{},this.group=!1;var r=this;this.selectPresetField=new t({model:this.model,label:n.select_preset_label,property:"preset",values:this.get_presets(),change:function(e){r.model.set_property("preset",this.get_value())}}),this.fields=_([this.selectPresetField]),Upfront.Application.user_can("CREATE_PRESET")&&this.listenTo(this.selectPresetField,"upfront:presets:new",this.createPreset),Upfront.Application.user_can("SWITCH_PRESET")&&this.listenTo(this.selectPresetField,"changed",this.changePreset)},changePreset:function(){if(!Upfront.Application.user_can("SWITCH_PRESET"))return!1;this.trigger("upfront:presets:change",this.selectPresetField.get_value())},createPreset:function(e){if(!Upfront.Application.user_can("CREATE_PRESET"))return!1;this.trigger("upfront:presets:new",e)},get_title:function(){return n.select_preset},get_presets:function(){var e=[];return _.each(this.options.presets.models,function(t){if(typeof t.get("legacy")!="undefined")return;"undefined"==typeof t.get("name")?e.push({label:t.get("id"),value:t.get("id")}):e.push({label:t.get("name"),value:t.get("id")})}),e}});return r});