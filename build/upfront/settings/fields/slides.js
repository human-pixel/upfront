!function(e){upfrontrjs.define(["text!elements/upfront-slider/tpl/backend.html"],function(t){var i=Upfront.Settings.l10n.slider_element,n=Upfront.Views.Editor.Field.Field.extend({template:_.template(e(t).find("#slides-setting-tpl").html()),events:{"click .uslider-add":"addSlides","click .remove-slide":"onRemoveSlide"},initialize:function(){this.listenTo(this.model.slideCollection,"add remove sort reset",this.render)},getSlideIndex:function(t){var i;return e(".uslider_content_imgslide",t.parent()).each(function(e,n){n===t[0]&&(i=e)}),i},onRemoveSlide:function(t){this.model.view.removeSlide(this.getSlideIndex(e(t.currentTarget).parent()))},render:function(){var t=this;this.$el.html(this.template({slides:this.model.slideCollection,l10n:i})),this.$(".uslider-slides-setting").sortable({items:".uslider_content_imgslide",start:function(e,t){t.item.addClass("uslider-is-dragged")},stop:function(e,i){var n=i.item.attr("rel"),l=t.getSlidePosition(n),s=!1;l!=-1&&(s=t.model.slideCollection.get(n),t.model.slideCollection.remove(n,{silent:!0}),t.model.slideCollection.add(s,{at:l}))}}),setTimeout(function(){var t=e("#settings");t.height(t.find(".upfront-settings_panel:visible").outerHeight())},100)},addSlides:function(){this.model.trigger("addRequest")},getSlidePosition:function(t){var i=0,n=!1;return this.$("div.uslider_content_slide").each(function(l){e(this).attr("rel")==t&&(n=i),i++}),n!==!1?n:-1},get_name:function(){return"slides"},get_value:function(){return this.model.slideCollection.toJSON()}});return n})}(jQuery);