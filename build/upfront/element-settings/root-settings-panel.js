!function(e){define(["scripts/upfront/element-settings/settings-container","scripts/upfront/element-settings/root-panel-mixin","scripts/upfront/settings/field-factory","scripts/upfront/settings/module-factory"],function(t,n,i,s){var a=(Upfront.Settings&&Upfront.Settings.l10n?Upfront.Settings.l10n.global.views:Upfront.mainData.l10n.global.views,t.extend(_.extend({},n,{initialize:function(e){var t=Upfront.Application.is_plugin_layout();if(!t){var n=this,a=[];this.options=e,this.settings=_(this.settings),this.settings.each(function(e){var t;t="SettingsItem"===e.type?new Upfront.Views.Editor.Settings.Item({title:e.title,model:n.model,className:e.className,fields:[]}):s.createModule(e.type,e||{},n.model),e.identifier&&(t.identifier=e.identifier),_.each(e.fields,function(s){var a;"change"in s&&(s.preservedChangeCallback||(s.preservedChangeCallback=s.change),s.change=function(e){s.preservedChangeCallback(e,n)},Upfront.Events.once("entity:settings:deactivate",function(){s.change=s.preservedChangeCallback})),"show"in s&&(s.preservedShowCallback||(s.preservedShowCallback=s.show),s.show=function(e){s.preservedShowCallback(e,n)},Upfront.Events.once("entity:settings:deactivate",function(){s.show=s.preservedShowCallback})),a=i.createField(s.type,_.extend({model:n.model},_.omit(s,["type"]))),e.triggerChange&&n.listenTo(a,"change changed",function(){n.save_settings(),n.model.trigger("change",n.model)}),s.identifier&&(a.identifier=s.identifier),t.fields.push(a)}),t.panel=n,t.trigger("panel:set"),a.push(t)}),this.settings=_(a)}},getBody:function(){var t=e("<div />"),n=this,i=Upfront.Application.is_plugin_layout();return i?(t.append("<div>This content is handled by "+i.pluginName+".</div>"),t):(this.settings.each(function(e){e.panel||(e.panel=n),e.render(),t.append(e.el)}),t)}})));return a})}(jQuery);