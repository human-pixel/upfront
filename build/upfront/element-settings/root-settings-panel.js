(function(e){define(["scripts/upfront/element-settings/settings-container","scripts/upfront/element-settings/root-panel-mixin","scripts/upfront/settings/field-factory","scripts/upfront/settings/module-factory"],function(t,n,r,i){var s=Upfront.Settings&&Upfront.Settings.l10n?Upfront.Settings.l10n.global.views:Upfront.mainData.l10n.global.views,o=t.extend(_.extend({},n,{initialize:function(e){var t=this,n=[];this.options=e,this.settings=_(this.settings),this.settings.each(function(e){var s;e.type==="SettingsItem"?s=new Upfront.Views.Editor.Settings.Item({title:e.title,model:t.model,className:e.className,fields:[]}):s=i.createModule(e.type,e||{},t.model),e.identifier&&(s.identifier=e.identifier),_.each(e.fields,function(e){var n;"change"in e&&(e.preservedChangeCallback||(e.preservedChangeCallback=e.change),e.change=function(n){e.preservedChangeCallback(n,t)},Upfront.Events.once("entity:settings:deactivate",function(){e.change=e.preservedChangeCallback})),"show"in e&&(e.preservedShowCallback||(e.preservedShowCallback=e.show),e.show=function(n){e.preservedShowCallback(n,t)},Upfront.Events.once("entity:settings:deactivate",function(){e.show=e.preservedShowCallback})),n=r.createField(e.type,_.extend({model:t.model},_.omit(e,["type"]))),e.identifier&&(n.identifier=e.identifier),s.fields.push(n)}),s.panel=t,s.trigger("panel:set"),n.push(s)}),this.settings=_(n)},getBody:function(){var t=e("<div />");return this.settings.each(function(e){e.panel||(e.panel=me),e.render(),t.append(e.el)}),t}}));return o})})(jQuery);