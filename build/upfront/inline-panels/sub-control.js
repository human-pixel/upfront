!function(e){define(["scripts/upfront/inline-panels/item","scripts/upfront/inline-panels/control"],function(n,t){var i=Upfront.mainData.l10n.image_element,s=t.extend({multiControl:!0,events:{click:"onClickControl","click .upfront-inline-panel-item":"selectItem"},initialize:function(){var n=this;e(document).click(function(t){var i=e(t.target);i.closest("#page").length&&i[0]!==n.el&&!i.closest(n.el).length&&n.isOpen&&n.close()}),this.listenTo(Upfront.Events,"upfront:hide:subControl",this.close)},onClickControl:function(e){this.isDisabled||(e.preventDefault(),this.clicked(e),this.$el.siblings(".upfront-sub-control-dialog-open").removeClass("upfront-sub-control-dialog-open"),this.isOpen?this.close():this.open())},open:function(){this.isOpen=!0,this.$el.addClass("upfront-sub-control-dialog-open"),Upfront.Events.trigger("upfront:hide:paddingPanel"),this.trigger("panel:open");var e=this.$el.closest(".upfront-inline-panel");this.inline===!0&&e.removeClass("upfront-panels-shadow"),this.updateWidth()},close:function(){this.isOpen=!1,this.$el.removeClass("upfront-sub-control-dialog-open"),this.trigger("panel:close");var e=this.$el.closest(".upfront-inline-panel");this.inline===!0&&(e.hasClass("upfront-panels-shadow")||e.addClass("upfront-panels-shadow"))},render:function(){n.prototype.render.call(this,arguments);var t=this.$(".image-sub-control"),i=this;this.item_count=0,t.length||(t=e(this.inline===!0?'<div class="image-sub-control upfront-panels-shadow inline-panel-sub-control-no-dropdown inline-panel-sub-control-dialog"></div>':'<div class="image-sub-control upfront-panels-shadow inline-panel-sub-control-dialog"></div>'),this.$el.append(t)),_.each(this.sub_items,function(e,n){n===i.selected?e.setIsSelected(!0):e.setIsSelected(!1),i.inline===!0&&(e.panel_type="tooltip"),e.render(),e.delegateEvents(),t.append(e.$el),i.item_count++});var s='<span class="upfront-control-arrow"></span>';this.$el.find(".image-sub-control").prepend(s)},updateWidth:function(){this.$el.find(".image-sub-control").css("width",28*this.item_count+2),this.$el.find(".upfront-inline-panel-item").show()},get_selected_item:function(){return this.selected},setDisabled:function(e){this.isDisabled=e,e?this.tooltip=i.ctrl.caption_position_disabled:this.tooltip=i.ctrl.caption_display}});return s})}(jQuery);