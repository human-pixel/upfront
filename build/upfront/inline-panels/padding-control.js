!function(t){define(["scripts/upfront/inline-panels/item","scripts/upfront/inline-panels/control"],function(n,e){var i=Upfront.mainData.l10n.global.views,d=e.extend({multiControl:!0,events:{click:"onClickControl"},initialize:function(){var n=this;t(document).click(function(e){var i=t(e.target);i.closest("#page").length&&i[0]!==n.el&&!i.closest(n.el).length&&n.isOpen&&n.close()}),t(document).mouseup(function(e){var i=t(e.target),d=Upfront.data.currentEntity;i.closest("#page").length&&i[0]!==n.el&&!i.closest(n.el).length&&"undefined"!=typeof d&&"undefined"!=typeof d.padding_hint_locked&&d.padding_hint_locked&&(d.padding_hint_locked=!1,d.top_padding_hint_timer=setTimeout(function(){"function"==typeof d.hide_top_padding_hint&&d.hide_top_padding_hint()},1e3),d.bottom_padding_hint_timer=setTimeout(function(){"function"==typeof d.hide_bottom_padding_hint&&d.hide_bottom_padding_hint()},1e3))}),this.default_padding={top:!1,bottom:!1},this.listenTo(Upfront.Events,"upfront:paddings:updated",this.refresh)},onClickControl:function(n){var e=t(n.target);if(!this.isDisabled){if(n.preventDefault(),!e.closest(".upfront-icon-region-padding").length)return void n.stopPropagation();this.clicked(n),this.$el.siblings(".upfront-control-dialog-open").removeClass("upfront-control-dialog-open"),this.listenTo(Upfront.Events,"upfront:hide:paddingPanel",this.close),this.isOpen?this.close():this.open()}},open:function(){this.isOpen=!0,this.refresh(),this.$el.addClass("upfront-control-dialog-open"),Upfront.Events.trigger("upfront:hide:subControl")},close:function(){this.isOpen=!1,this.$el.removeClass("upfront-control-dialog-open"),this.$el.closest(".upfront-inline-panel-item-open").removeClass("upfront-inline-panel-item-open")},on_render:function(){var n=this,e=n.$(".upfront-padding-control"),d=t('<div class="upfront-padding-container">'+i.top_padding_short+'<span class="upfront-padding-value"></span></div>'),o=t('<div class="upfront-padding-container">'+i.bottom_padding_short+'<span class="upfront-padding-value"></span></div>'),p=t('<div class="upfront-padding-container"></div>'),a=Upfront.Settings.LayoutEditor.Grid.column_padding;n.$el.hasClass("upfront-padding-control-item")||n.$el.addClass("upfront-padding-control-item"),0===e.length&&(e=t('<div class="upfront-padding-control inline-panel-control-dialog"></div>'),n.$el.append(e)),n.default_padding.top===!1&&(n.default_padding.top=a),n.default_padding.bottom===!1&&(n.default_padding.bottom=a),n.paddingTop=new Upfront.Views.Editor.Field.Slider({model:this.model,use_breakpoint_property:!0,property:"top_padding_num",label:"",default_value:this.model.get_breakpoint_property_value("top_padding_num")||n.default_padding.top,min:0,max:200,step:5,valueTextFilter:function(t){return n.paddingTop.$el.parent(".upfront-padding-container").find(".upfront-padding-value").html(t),""},change:function(){var t=this.get_value();this.model.set_breakpoint_property("use_padding","yes",!0),this.model.set_breakpoint_property("lock_padding","",!0),this.model.set_breakpoint_property("top_padding_use","yes",!0),this.model.set_breakpoint_property("top_padding_slider",t,!0),this.model.set_breakpoint_property("top_padding_num",t),Upfront.Events.trigger("upfront:paddings:updated",this.model,Upfront.data.currentEntity),Upfront.Events.trigger("upfront:paddings:top:updated",this.model,Upfront.data.currentEntity)},callbacks:{stop:function(n){var e=t(this).data("uiSlider");e&&_.isObject(e)&&"handle"in e&&e.handle.blur()}}}),n.paddingBottom=new Upfront.Views.Editor.Field.Slider({model:this.model,use_breakpoint_property:!0,property:"bottom_padding_num",label:"",default_value:this.model.get_breakpoint_property_value("bottom_padding_num")||n.default_padding.bottom,min:0,max:200,step:5,valueTextFilter:function(t){return n.paddingBottom.$el.parent(".upfront-padding-container").find(".upfront-padding-value").html(t),""},change:function(){var t=this.get_value();this.model.set_breakpoint_property("use_padding","yes",!0),this.model.set_breakpoint_property("lock_padding","",!0),this.model.set_breakpoint_property("bottom_padding_use","yes",!0),this.model.set_breakpoint_property("bottom_padding_slider",t,!0),this.model.set_breakpoint_property("bottom_padding_num",t),Upfront.Events.trigger("upfront:paddings:updated",this.model,Upfront.data.currentEntity),Upfront.Events.trigger("upfront:paddings:bottom:updated",this.model,Upfront.data.currentEntity)},callbacks:{stop:function(n){var e=t(this).data("uiSlider");e&&_.isObject(e)&&"handle"in e&&e.handle.blur()}}}),e.html(""),n.paddingTop.render(),d.append(n.paddingTop.$el),e.append(d),n.paddingBottom.render(),o.append(n.paddingBottom.$el),e.append(o),void 0!==n.model.attributes.modules||n.model.get_property_value_by_name("code_selection_type")||(n.advancedPadding=new Upfront.Views.Editor.Field.Button({className:"upfront-field-wrap upfront-field-wrap-button upfront-field-advanced-padding",compact:!0,label:i.advanced_padding,name:"advanced-padding"}),n.advancedPadding.render(),p.append(n.advancedPadding.$el),e.append(p)),d.on("mousedown",function(){Upfront.data.currentEntity.padding_hint_locked=!0}).on("mouseup",function(){var t=Upfront.data.currentEntity;t.padding_hint_locked=!1,t.top_padding_hint_timer=setTimeout(function(){"function"==typeof t.hide_top_padding_hint&&t.hide_top_padding_hint()},1e3)}),o.on("mousedown",function(){Upfront.data.currentEntity.padding_hint_locked=!0}).on("mouseup",function(){var t=Upfront.data.currentEntity;t.padding_hint_locked=!1,t.bottom_padding_hint_timer=setTimeout(function(){"function"==typeof t.hide_bottom_padding_hint&&t.hide_bottom_padding_hint()},1e3)})},refresh:function(t){if(!t||t===this.model){var n,e,i=Upfront.Settings.LayoutEditor.Grid.column_padding,d=this.model.get_breakpoint_property_value("top_padding_use",!0),o=this.model.get_breakpoint_property_value("bottom_padding_use",!0);this.default_padding.top===!1&&(this.default_padding.top=i),this.default_padding.bottom===!1&&(this.default_padding.bottom=i),n=d?this.model.get_breakpoint_property_value("top_padding_num",!0):this.default_padding.top,e=o?this.model.get_breakpoint_property_value("bottom_padding_num",!0):this.default_padding.bottom,"undefined"!=typeof this.paddingTop&&(this.paddingTop.get_field().val(n),"undefined"!=typeof this.paddingTop.$el.find("#"+this.paddingTop.get_field_id()).slider("instance")&&this.paddingTop.$el.find("#"+this.paddingTop.get_field_id()).slider("value",n),this.paddingTop.$el.parent(".upfront-padding-container").find(".upfront-padding-value").html(n)),"undefined"!=typeof this.paddingBottom&&(this.paddingBottom.get_field().val(e),"undefined"!=typeof this.paddingBottom.$el.find("#"+this.paddingBottom.get_field_id()).slider("instance")&&this.paddingBottom.$el.find("#"+this.paddingBottom.get_field_id()).slider("value",e),this.paddingBottom.$el.parent(".upfront-padding-container").find(".upfront-padding-value").html(e))}},on_up_arrow_click:function(){if("undefined"!=typeof this.paddingTop){var t=parseInt(this.model.get_breakpoint_property_value("top_padding_num",!0))-5;t=0>t?0:t,this.model.set_breakpoint_property("top_padding_use","yes"),this.model.set_breakpoint_property("top_padding_num",t),this.model.set_breakpoint_property("top_padding_slider",t),this.refresh()}},on_down_arrow_click:function(){if("undefined"!=typeof this.paddingTop){var t=parseInt(this.model.get_breakpoint_property_value("top_padding_num",!0))+5;this.model.set_breakpoint_property("top_padding_use","yes"),this.model.set_breakpoint_property("top_padding_num",t),this.model.set_breakpoint_property("top_padding_slider",t),this.refresh()}}});return d})}(jQuery);