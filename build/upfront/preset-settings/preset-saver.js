(function(e){define([],function(){var t=function(){var t={},n=function(e,t,r){var i=t.pop();Upfront.Util.post({action:"upfront_save_"+e+"_preset",data:i}).done(function(){t.length>0?n(e,t,r):r.resolve()}).fail(function(){r.reject(),Upfront.Views.Editor.notify("Preset "+i.name+" save failed.")})};this.savePresets=function(){var r=[];return result=e.Deferred(),_.each(t,function(t,i){if(t.length>0){var s=e.Deferred();r.push(s),n(i,t,s)}}),r.length>0?(e.when.apply(e,r).done(function(){result.resolve()}).fail(function(){result.reject()}),result):result.resolve()},this.queuePresetSave=function(e,n){t[n]=t[n]||[],t[n]=_.reject(t[n],function(t){return t.id===e.id}),t[n].push(e)}},n=new t;return n})})(jQuery);