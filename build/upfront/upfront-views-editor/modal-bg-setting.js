!function(e){var t=Upfront.Settings&&Upfront.Settings.l10n?Upfront.Settings.l10n.global.views:Upfront.mainData.l10n.global.views;define(["scripts/upfront/upfront-views-editor/modal","scripts/upfront/upfront-views-editor/fields","text!upfront/templates/region_edit_panel.html"],function(i,o,n){return i.extend({open:function(){return this.constructor.__super__.open.call(this,this.render_modal,this,!0)},render_modal:function(i,r){var l=this,a=Upfront.Settings.LayoutEditor.Grid,s=Upfront.Settings.LayoutEditor.CurrentBreakpoint,d=s&&!s["default"],g=this.model instanceof Upfront.Models.Layout,p=this.model instanceof Upfront.Models.Region,m=p&&this.model.is_main()?!1:this.model.get("sub"),h=this.model.get_breakpoint_property_value("background_image",!0),u=e(n),c=_.template(u.find("#upfront-region-bg-setting").html()),b=c(),f=[{label:t.solid_color,value:"color",icon:"color"},{label:t.image,value:"image",icon:"image"},{label:t.video,value:"video",icon:"video"}];g||(f.push({label:t.image_slider,value:"slider",icon:"slider"}),f.push({label:t.map,value:"map",icon:"map"})),(_upfront_post_data.post_id||!0===Upfront.plugins.isRequiredByPlugin("show feature image region type")&&"type"in _upfront_post_data.layout&&"single"===_upfront_post_data.layout.type)&&("item"in _upfront_post_data.layout&&_upfront_post_data.layout.item.match(/single-404/)||f.push({label:t.featured_image,value:"featured",icon:"feat"}));var v,y,w,k,x,$,U,E,R,z=new o.Select({model:this.model,property:"background_type",use_breakpoint_property:!0,default_value:h?"image":"color",icon_class:"upfront-region-field-icon",values:f,change:function(){var e=this.get_value();this.model.set_breakpoint_property(this.property_name,e),i.find(".upfront-region-bg-setting-tab").not(".upfront-region-bg-setting-tab-"+e).hide(),i.find(".upfront-region-bg-setting-tab-"+e).show(),l.render_modal_tab(e,i.find(".upfront-region-bg-setting-tab-"+e),i)}});new Upfront.Views.Editor.BgSettings.BgItem({model:this.model});if(!d&&p)var C=new o.Text({model:this.model,name:"title",placeholder:t.region_name_placeholder,compact:!0,change:function(){},blur:function(){var t,i,o,n=this.model.collection,r=this.model.get("title"),a=(this.model.get("name"),e.trim(this.get_value().replace(/[^A-Za-z0-9\s_-]/g,""))),s=a.toLowerCase().replace(/\s/g,"-");r!=a&&(n.get_by_name(s)&&(t=n.get_new_title(a+" ",2),a=t.title,s=t.name),o=l.get_region_css_styles(this.model),this.model.is_main()?(i=this.model.get_sub_regions(),_.each(i,function(e,t){_.isArray(e)?_.each(e,function(e){e.set({container:s},{silent:!0})}):_.isObject(e)&&e.set({container:s},{silent:!0})}),this.model.set({title:a,name:s,container:s},{silent:!0})):this.model.set({title:a,name:s},{silent:!0}),y.find(".upfront-region-name-edit-value").text(a),l.set_region_css_styles(this.model,o.styles,o.selector),this.model.get("properties").trigger("change"))},rendered:function(){var e=this;this.get_field().on("keyup",function(t){13===t.which&&e.trigger("blur")})}}),V=new o.Checkboxes({model:this.model,name:"scope",multiple:!1,values:[{label:t.make_global,value:"global"}],change:function(){var e=this.get_value();"global"==e&&(l.apply_region_scope(this.model,"global"),y.find(".upfront-region-bg-setting-is-global").show())}}),S=new o.Button({model:this.model,name:"localize",label:t.localize_region,classname:"upfront-region-bg-setting-localize",compact:!0,on_click:function(){l.apply_region_scope(this.model,"local"),y.find(".upfront-region-bg-setting-name-wrap").show(),$region_auto.show(),y.find(".upfront-region-bg-setting-name-edit").hide(),y.find(".upfront-region-bg-setting-is-global").hide(),V.$el.find("[value=global]").prop("checked",!1),V.$el.show(),this.$el.hide()},rendered:function(){this.$el.attr("title",t.localize_region_info)}}),F=new o.Button({model:this.model,name:"save",label:t.save,compact:!0,classname:"upfront-region-bg-setting-name-save",on_click:function(){y.find(".upfront-region-bg-setting-name-wrap").show(),$region_auto.show(),y.find(".upfront-region-bg-setting-name-edit").hide(),"global"==this.model.get("scope")?(V.$el.hide(),S._no_display||S.$el.show()):V.$el.show()}});if(g)var A=new o.Number({model:this.model,property:"contained_region_width",label:t.contained_region_width,label_style:"inline",default_value:a.size*a.column_width,min:a.size*a.column_width,max:5120,step:1,suffix:t.px,change:function(){var e=this.get_value();e=e<this.options.min?this.options.min:e,this.property.set({value:e}),Upfront.Events.trigger("upfront:layout:contained_region_width",e)}});if(p&&this.model.is_main())var N=_.findWhere(Upfront.Application.current_subapplication.get_layout_data().properties,{name:"global_regions"}),B=_.isUndefined(N)?!1:_.findWhere(N.value,{name:"header"}),q=_.isUndefined(N)?!1:_.findWhere(N.value,{name:"footer"}),I=this.model.collection,M=I.indexOf(this.model),L=I.index_container(this.model,["shadow","lightbox"]),T=I.total_container(["shadow","lightbox"]),j=0==L,D=L==T-1,G=I.findWhere({sticky:"1"}),W=[{label:t.full_width,value:"wide"},{label:t.contained,value:"clip"}],W=L>0?W:_.union([{label:t.full_screen,value:"full"}],W),O=(new o.Checkboxes({model:this.model,name:"scope",multiple:!1,values:[{label:j?t.use_as_global_header:D?t.use_as_global_footer:"",value:"global"}],change:function(){var e=this.get_value(),i=(this.model.get_sub_regions(),!1),o=!1,n=!1,r=!1;"global"==e?(o=j?t.header:D?t.footer:"",n=j?"header":D?"footer":"",o&&n&&(r=this.model.collection.get_by_name(n),r&&r!=this.model&&(i=this.model.collection.get_new_title("Region ",T),l.apply_region_scope(r,"local",i.name,i.title)),l.apply_region_scope(this.model,"global",n,o))):l.apply_region_scope(this.model,"local")}}),new o.Button({model:this.model,label:j?t.add_global_header:t.add_global_footer,info:j?t.layout_no_global_header:t.layout_no_global_footer,compact:!0,on_click:function(e){e.preventDefault();var t=new Upfront.Models.Region(j?B:q),i=this.model.collection.get_by_name(j?"header":"footer"),o=!1;i&&(o=this.model.collection.get_new_title("Region ",T),l.apply_region_scope(i,"local",o.name,o.title)),Upfront.Events.once("entity:region:added",function(e){e.trigger("activate_region",e)},this),t.add_to(this.model.collection,j?0:M+1),l.close()}}),new o.Radios({model:this.model,name:"type",default_value:"wide",layout:"horizontal-inline",values:W,change:function(){var e=this.get_value();this.model.set({type:e},{silent:!0}),"full"==e?(x.show(),$.show()):(x.hide(),$.hide()),this.model.get("properties").trigger("change"),l.update_pos(),Upfront.Events.trigger("command:region:edit_toggle",!1),Upfront.Events.trigger("command:region:edit_toggle",!0)}})),P=this.model.get_property_value_by_name("nav_region"),Q=new o.Checkboxes({model:this.model,property:"sub_regions",default_value:this.model.get_property_value_by_name("sub_regions")?[]:[P],layout:"horizontal-inline",multiple:!0,values:[{label:t.top,value:"top"},{label:t.bottom,value:"bottom"}],change:function(){var e=this.get_value(),t=l.model.get_sub_regions(),i=!1;M=I.indexOf(l.model),!_.contains(e,"top")&&t.top&&(i=Upfront.Util.model_to_json(t.top),l._sub_region_top_copy=new Upfront.Models.Region(i),I.remove(t.top)),!_.contains(e,"bottom")&&t.bottom&&(i=Upfront.Util.model_to_json(t.bottom),l._sub_region_bottom_copy=new Upfront.Models.Region(i),I.remove(t.bottom)),_.each(e,function(e){if(!t[e]){var i=!1,o=!1;if("bottom"==e?(l._sub_region_bottom_copy&&(o=l._sub_region_bottom_copy),i=t.right?M+2:M+1):"top"==e&&(l._sub_region_top_copy&&(o=l._sub_region_top_copy),i=t.left?M-1:M),i!==!1){var n=l.model.get("name")+"_"+e,r=l.model.get("title")+" "+e;o===!1&&(o=new Upfront.Models.Region(_.extend(_.clone(Upfront.data.region_default_args),{name:n,title:r,container:l.model.get("name"),sub:e,scope:l.model.get("scope")}))),o.add_to(I,i,{sub:e}),Upfront.Events.trigger("command:region:edit_toggle",!0)}}}),this.property.set({value:e})}}),Z=new o.Radios({model:this.model,name:"behavior",default_value:"keep-position",layout:"horizontal-inline",values:[{label:t.keep_position,value:"keep-position"},{label:t.keep_ratio,value:"keep-ratio"}],change:function(){var e=this.get_value();this.model.set({behavior:e},{silent:!0}),this.model.get("properties").trigger("change")}});else if(p&&"fixed"==m)var H=new o.Checkboxes({model:this.model,name:"restrict_to_container",default_value:"",layout:"horizontal-inline",values:[{label:t.restrict_to_parent,value:"1"}],change:function(){var e=this.get_value();this.model.set({restrict_to_container:e},{silent:!0}),this.model.trigger("restrict_to_container",e),this.model.get("properties").trigger("change")},multiple:!1});if(p)var J=new o.Radios({model:this.model,use_breakpoint_property:!0,property:"bg_padding_type",label:"",values:[{label:t.varied_padding,value:"varied"},{label:t.equal_padding,value:"equal"}],default_value:this.model.get_breakpoint_property_value("bg_padding_type")||"varied",change:function(){this.model.set_breakpoint_property("bg_padding_type",this.get_value())},show:function(t,o){"varied"===t?(e(".upfront-region-bg-setting-padding-top",i).show(),e(".upfront-region-bg-setting-padding-bottom",i).show(),e(".upfront-region-bg-setting-equal-padding",i).hide()):(e(".upfront-region-bg-setting-equal-padding",i).show(),e(".upfront-region-bg-setting-padding-top",i).hide(),e(".upfront-region-bg-setting-padding-bottom",i).hide())}}),K=new o.Slider({model:this.model,use_breakpoint_property:!0,property:"top_bg_padding_slider",label:"",default_value:this.model.get_breakpoint_property_value("top_bg_padding_slider")||0,min:0,max:200,step:5,valueTextFilter:function(){return""},change:function(){var e=this.get_value();this.model.set_breakpoint_property("top_bg_padding_slider",e),X.get_field().val(e),this.model.set_breakpoint_property("top_bg_padding_num",e,!0)}}),X=new o.Number({model:this.model,use_breakpoint_property:!0,property:"top_bg_padding_num",label:"",default_value:this.model.get_breakpoint_property_value("top_bg_padding_num")||0,prefix:t.bottom_padding,suffix:t.px,min:0,step:5,change:function(){var e=this.get_value();this.model.set_breakpoint_property("top_bg_padding_num",e),this.model.set_breakpoint_property("top_bg_padding_slider",e,!0),K.$el.find("#"+K.get_field_id()).slider("value",e)}}),Y=new o.Slider({model:this.model,use_breakpoint_property:!0,property:"bottom_bg_padding_slider",label:"",default_value:this.model.get_breakpoint_property_value("bottom_bg_padding_slider")||0,min:0,max:200,step:5,valueTextFilter:function(){return""},change:function(){var e=this.get_value();this.model.set_breakpoint_property("bottom_bg_padding_slider",e),ee.get_field().val(e),this.model.set_breakpoint_property("bottom_bg_padding_num",e,!0)}}),ee=new o.Number({model:this.model,use_breakpoint_property:!0,property:"bottom_bg_padding_num",label:"",default_value:this.model.get_breakpoint_property_value("bottom_bg_padding_num")||0,suffix:t.px,min:0,step:5,change:function(){var e=this.get_value();this.model.set_breakpoint_property("bottom_bg_padding_num",e),this.model.set_breakpoint_property("bottom_bg_padding_slider",e,!0),Y.$el.find("#"+Y.get_field_id()).slider("value",e)}}),te=new o.Slider({model:this.model,use_breakpoint_property:!0,property:"bg_padding_slider",label:"",default_value:this.model.get_breakpoint_property_value("bg_padding_slider")||0,min:0,max:200,step:5,valueTextFilter:function(){return""},change:function(){var e=this.get_value();this.model.set_breakpoint_property("bg_padding_slider",e),this.model.set_breakpoint_property("top_bg_padding_slider",e,!0),this.model.set_breakpoint_property("bottom_bg_padding_slider",e,!0),K.$el.find("#"+K.get_field_id()).slider("value",e),Y.$el.find("#"+Y.get_field_id()).slider("value",e),ie.get_field().val(e),X.get_field().val(e),ee.get_field().val(e),this.model.set_breakpoint_property("bg_padding_num",e,!0),this.model.set_breakpoint_property("top_bg_padding_num",e,!0),this.model.set_breakpoint_property("bottom_bg_padding_num",e,!0)}}),ie=new o.Number({model:this.model,use_breakpoint_property:!0,property:"bg_padding_num",label:"",default_value:this.model.get_breakpoint_property_value("bg_padding_num")||0,suffix:t.px,min:0,step:5,change:function(){var e=this.get_value();this.model.set_breakpoint_property("bg_padding_num",e),X.get_field().val(e),ee.get_field().val(e),this.model.set_breakpoint_property("top_bg_padding_num",e,!0),this.model.set_breakpoint_property("bottom_bg_padding_num",e,!0),this.model.set_breakpoint_property("bg_padding_slider",e,!0),this.model.set_breakpoint_property("top_bg_padding_slider",e,!0),this.model.set_breakpoint_property("bottom_bg_padding_slider",e,!0),te.$el.find("#"+te.get_field_id()).slider("value",e),K.$el.find("#"+K.get_field_id()).slider("value",e),Y.$el.find("#"+Y.get_field_id()).slider("value",e)}});if(i.find(".upfront-region-bg-setting-tab-primary, .upfront-region-bg-setting-tab-secondary").children().detach(),i.html(b),r.addClass("upfront-region-modal-bg"),$fixed=i.find(".upfront-region-bg-setting-fixed-region"),$fixed.hide(),$lightbox=i.find(".upfront-region-bg-setting-lightbox-region"),$lightbox.hide(),v=i.find(".upfront-region-bg-setting-header"),y=i.find(".upfront-region-bg-setting-name"),w=i.find(".upfront-region-bg-setting-region-global"),$add_global_region=i.find(".upfront-region-bg-setting-add-global-region"),k=i.find(".upfront-region-bg-setting-region-type"),x=i.find(".upfront-region-bg-setting-region-nav"),$=i.find(".upfront-region-bg-setting-region-behavior"),U=i.find(".upfront-region-bg-setting-floating-restrict"),E=i.find(".upfront-region-bg-setting-sticky"),$region_auto=i.find(".upfront-region-bg-setting-auto-resize"),$region_padding_type=i.find(".upfront-region-bg-setting-padding-type"),$region_equal_padding=i.find(".upfront-region-bg-setting-equal-padding"),$region_top_padding=i.find(".upfront-region-bg-setting-padding-top"),$region_bottom_padding=i.find(".upfront-region-bg-setting-padding-bottom"),!d&&p){if(C.render(),V.render(),S.render(),F.render(),y.find(".upfront-region-bg-setting-name-edit").append([C.$el,V.$el,S.$el,F.$el]).hide(),y.find(".upfront-region-name-edit-value").text(this.model.get("title")),"global"==this.model.get("scope")){if(y.find(".upfront-region-bg-setting-is-global").show(),V.$el.hide(),!this.model.is_main()&&m){var oe=this.model.collection.get_by_name(this.model.get("container"));oe&&"global"==oe.get("scope")&&(S.$el.hide(),S._no_display=!0)}}else y.find(".upfront-region-bg-setting-is-global").hide(),S.$el.hide();y.on("click",".upfront-region-name-edit-trigger",function(e){e.preventDefault(),y.find(".upfront-region-bg-setting-name-wrap").hide(),$region_auto.hide(),y.find(".upfront-region-bg-setting-name-edit").show(),"global"!=l.model.get("scope")?C.get_field().prop("disabled",!1).trigger("focus").select():C.get_field().prop("disabled",!0)})}else v.hide();if(!d&&p&&this.model.is_main()?(O.render(),k.append(O.$el),Q.render(),x.append(Q.$el),Z.render(),$.append(Z.$el)):(w.hide(),k.hide(),x.hide(),$.hide(),$region_auto.hide()),U.hide(),E.hide(),!d&&p&&(this.model.is_main()||"top"==m||"bottom"==m)&&(!G&&this.for_view.$el.height()<=300||this.model.get("sticky"))){var ne=new o.Checkboxes({model:this.model,name:"sticky",default_value:"",layout:"horizontal-inline",values:[{label:t.sticky_region,value:"1"}],change:function(){var e=this.get_value();this.model.set({sticky:e},{silent:!0}),this.model.get("properties").trigger("change")},multiple:!1});ne.render(),E.append(ne.$el).show()}if(R=i.find(".upfront-region-bg-setting-theme-body"),g?(A.render(),R.append(A.$el),i.find(".upfront-region-bg-setting-edit-css").hide()):R.hide(),"lightbox"!=this.model.attributes.sub?(z.render(),i.find(".upfront-region-bg-setting-type").append(z.$el)):i.find(".upfront-region-bg-setting-type").remove(),i.find(".upfront-region-bg-setting-edit-css").on("click",function(e){e.preventDefault(),e.stopPropagation(),l.trigger_edit_css()}),p&&this.model.is_main()){var re=i.find(".upfront-region-bg-setting-auto-resize");re.on("click",function(t){t.preventDefault(),t.stopPropagation(),l.trigger_expand_lock(e(this))}),this.render_expand_lock(re),this.listenTo(O,"changed",function(){l.render_expand_lock(re)}),d||O.trigger("changed")}else p&&"fixed"==m?(this.render_fixed_settings($fixed),$fixed.show(),H.render(),U.append(H.$el).show()):p&&"lightbox"==m?(this.render_lightbox_settings($lightbox),$lightbox.show()):i.find(".upfront-region-bg-setting-auto-resize").hide();p&&(J.render(),$region_padding_type.append(J.$el),K.render(),$region_top_padding.append(K.$el),X.render(),$region_top_padding.append(X.$el),Y.render(),$region_bottom_padding.append(Y.$el),ee.render(),$region_bottom_padding.append(ee.$el),te.render(),$region_equal_padding.append(te.$el),ie.render(),$region_equal_padding.append(ie.$el)),g&&!p&&i.find(".upfront-region-bg-setting-padding").hide(),z.trigger("changed")},on_close_modal:function(){var e=this;e._active=!1,e.render_icon()},notify:function(){Upfront.Views.Editor.notify(t.bg_updated)},apply_region_scope:function(e,t,i,o){var n,r=this,l=e.get_sub_regions(),a=e.get("title"),s=e.get("name"),d=function(e){var n=r.get_region_css_styles(e);if(e.set({scope:t},{silent:!0}),i&&s!=i){var l=new RegExp("^"+a,"i"),d=new RegExp("^"+s,"i"),_=e.get("title").replace(l,o),g=e.get("name").replace(d,i);e.set({container:i,title:_,name:g},{silent:!0})}r.set_region_css_styles(e,n.styles,n.selector),e.get("properties").trigger("change")};e.is_main()&&_.each(l,function(e){_.isArray(e)?_.each(e,function(e){d(e)}):e&&d(e)}),n=r.get_region_css_styles(e),e.set({scope:t},{silent:!0}),i&&s!=i&&e.set({title:o,name:i,container:i},{silent:!0}),r.set_region_css_styles(e,n.styles,n.selector),e.get("properties").trigger("change")},get_region_css_styles:function(t){return Upfront.Application.cssEditor.init({model:t,type:t.is_main()?"RegionContainer":"Region",element_id:t.is_main()?"region-container-"+t.get("name"):"region-"+t.get("name"),no_render:!0}),{styles:e.trim(Upfront.Application.cssEditor.get_style_element().html()),selector:Upfront.Application.cssEditor.get_css_selector()}},set_region_css_styles:function(e,t,i){t&&(Upfront.Application.cssEditor.init({model:e,type:e.is_main()?"RegionContainer":"Region",element_id:e.is_main()?"region-container-"+e.get("name"):"region-"+e.get("name"),no_stylename_fallback:!0,no_render:!0}),selector=Upfront.Application.cssEditor.get_css_selector(),i!=selector&&(t=t.replace(new RegExp(i.replace(/^\./,"."),"g"),selector)),Upfront.Application.cssEditor.get_style_element().html(t),Upfront.Application.cssEditor.saveCall(!1))},render_fixed_settings:function(e){var i=Upfront.Settings.LayoutEditor.Grid,o=this.model.get_property_value_by_name("top"),n="number"==typeof o,r=this.model.get_property_value_by_name("left"),l="number"==typeof r,a=this.model.get_property_value_by_name("bottom"),s="number"==typeof a,d=this.model.get_property_value_by_name("right"),g="number"==typeof d,p=function(){var e=this.get_value(),t=this.get_saved_value();if(e!=t){switch(this.options.property){case"top":this.model.remove_property("bottom",!0);break;case"bottom":this.model.remove_property("top",!0);break;case"left":this.model.remove_property("right",!0);break;case"right":this.model.remove_property("left",!0)}this.property.set({value:parseInt(e,10)})}},m={width:new Upfront.Views.Editor.Field.Number({model:this.model,property:"width",label:t.width+":",label_style:"inline",min:3*i.column_width,max:Math.floor(i.size/2)*i.column_width,change:p}),height:new Upfront.Views.Editor.Field.Number({model:this.model,property:"height",label:t.height+":",label_style:"inline",min:3*i.baseline,change:p})};n||!s?m.top=new Upfront.Views.Editor.Field.Number({model:this.model,property:"top",label:t.top+":",label_style:"inline",min:0,change:p}):m.bottom=new Upfront.Views.Editor.Field.Number({model:this.model,property:"bottom",label:t.bottom+":",label_style:"inline",min:0,change:p}),l||!g?m.left=new Upfront.Views.Editor.Field.Number({model:this.model,property:"left",label:t.left+":",label_style:"inline",min:0,change:p}):m.right=new Upfront.Views.Editor.Field.Number({model:this.model,property:"right",label:t.right+":",label_style:"inline",min:0,change:p}),_.each(m,function(t){t.render(),t.delegateEvents(),e.append(t.$el)})},render_lightbox_settings:function(e){var i=this,o=Upfront.Settings.LayoutEditor.Grid,n=function(e){i=e.$spectrum?e:this;var t=i.get_value(),o=i.get_saved_value();t!=o&&i.property.set({value:t})},r={width:new Upfront.Views.Editor.Field.Number({model:this.model,property:"col",className:"upfront-field-wrap upfront-field-wrap-number width_cols",label:t.col_width+":",label_style:"inline",min:3,max:24,change:n}),height:new Upfront.Views.Editor.Field.Number({model:this.model,property:"height",label:t.px_height+":",label_style:"inline",min:3*o.baseline,max:99999,change:n}),click_out_close:new Upfront.Views.Editor.Field.Checkboxes({model:this.model,property:"click_out_close",label:"",values:[{label:t.click_close_ltbox,value:"yes",checked:"yes"==this.model.get_property_value_by_name("click_out_close")?"checked":!1}],change:n}),show_close:new Upfront.Views.Editor.Field.Checkboxes({model:this.model,property:"show_close",label:"",values:[{label:t.show_close_icon,value:"yes",checked:"yes"==this.model.get_property_value_by_name("show_close")?"checked":!1}],change:n})};r.overlay_color=new Upfront.Views.Editor.Field.Color({model:this.model,property:"overlay_color",className:"upfront-field-wrap upfront-field-wrap-color sp-cf overlay_color",default_value:"rgba(38,58,77,0.75)",label:t.overlay_bg+":",change:n,spectrum:{move:function(e){var t=e.toRgb(),i="rgba("+t.r+","+t.g+","+t.b+","+e.alpha+")";r.overlay_color.get_field().val(i),n(r.overlay_color)},change:function(e){var t=e.toRgb(),i="rgba("+t.r+","+t.g+","+t.b+","+e.alpha+")";r.overlay_color.get_field().val(i),n(r.overlay_color)}}}),r.lightbox_color=new Upfront.Views.Editor.Field.Color({model:this.model,property:"lightbox_color",default_value:"rgba(248,254,255,0.9)",label:t.active_area_bg+":",change:n,spectrum:{move:function(e){var t=e.toRgb(),i="rgba("+t.r+","+t.g+","+t.b+","+e.alpha+")";r.lightbox_color.get_field().val(i),n(r.lightbox_color)},change:function(e){var t=e.toRgb(),i="rgba("+t.r+","+t.g+","+t.b+","+e.alpha+")";r.lightbox_color.get_field().val(i),n(r.lightbox_color)}}}),_.each(r,function(t){t.render(),t.delegateEvents(),e.append(t.$el)}),this.model.set_property("delete",!1);var i=this;e.on("click","a.upfront-entity-delete_trigger",function(){i.model.set_property("delete",!0),i.close()}),e.closest(".upfront-inline-modal-wrap").draggable()},update_lightbox_overlay:function(e){var t=e.toRgb();"rgba("+t.r+","+t.g+","+t.b+","+e.alpha+")"},render_modal_tab:function(e,t,i){var o=i.find(".upfront-region-bg-setting-change-image");switch(o.hide(),e){case"color":this.render_modal_tab_color(t);break;case"image":o.show(),this.render_modal_tab_image(t,e);break;case"featured":this.render_modal_tab_image(t,e);break;case"slider":this.render_modal_tab_slider(t);break;case"map":this.render_modal_tab_map(t);break;case"video":this.render_modal_tab_video(t)}},_render_tab_template:function(t,i,o,r){var l=e(n),a=!1,s=!1;s=r?_.template(l.find("#upfront-region-bg-setting-tab-"+r).html()):_.template(l.find("#upfront-region-bg-setting-tab").html()),s&&(a=e("<div>"+s()+"</div>")),a.find(".upfront-region-bg-setting-tab-primary").append(i),o&&a.find(".upfront-region-bg-setting-tab-secondary").append(o),t.html(""),t.append(a)},render_modal_tab_color:function(e){this._color_item||(this._color_item=new Upfront.Views.Editor.BgSettings.ColorItem({model:this.model}),this._color_item.render()),this._color_item.trigger("show"),this._render_tab_template(e,this._color_item.$el,"")},render_modal_tab_image:function(e,t){this._image_item||(this._image_item=new Upfront.Views.Editor.BgSettings.ImageItem({model:this.model}),this._image_item.render(),this.$_image_primary=this._image_item.$el.find(".uf-bgsettings-image-style, .uf-bgsettings-image-pick")),this._image_item.trigger("show"),this._render_tab_template(e,this.$_image_primary,this._image_item.$el)},render_modal_tab_slider:function(t){this._slider_item||(this.$_slides=e('<div class="upfront-region-bg-slider-slides"></div>'),this._slider_item=new Upfront.Views.Editor.BgSettings.SliderItem({model:this.model,slides_item_el:this.$_slides}),this._slider_item.render(),this.$_slider_primary=this._slider_item.$el.find(".uf-bgsettings-slider-transition")),this._slider_item.trigger("show"),this._render_tab_template(t,this.$_slider_primary,[this._slider_item.$el,this.$_slides])},render_modal_tab_map:function(e){this._map_item||(this._map_item=new Upfront.Views.Editor.BgSettings.MapItem({model:this.model}),this._map_item.render()),this._map_item.trigger("show"),this._render_tab_template(e,"",this._map_item.$el)},render_modal_tab_video:function(e){this._video_item||(this._video_item=new Upfront.Views.Editor.BgSettings.VideoItem({model:this.model}),this._video_item.render()),this._video_item.trigger("show"),this._render_tab_template(e,"",this._video_item.$el)},render_expand_lock:function(i){var o=this.model.get_breakpoint_property_value("expand_lock",!0),n=this.model.get("type"),r=e("<span />");"full"==n?(i.addClass("upfront-region-bg-setting-auto-resize-disabled"),i.attr("title",t.auto_resize_disabled_title)):(i.removeClass("upfront-region-bg-setting-auto-resize-disabled"),i.removeAttr("title")),o?r.addClass("auto-resize-off"):r.addClass("auto-resize-on"),i.html(""),i.append("<span>"+t.auto_resize+"</span>"),i.append(r)},trigger_expand_lock:function(e){if(!e.hasClass("upfront-region-bg-setting-auto-resize-disabled")){var t=this.model.get_breakpoint_property_value("expand_lock");this.model.set_breakpoint_property("expand_lock",!t),this.render_expand_lock(e)}},trigger_edit_css:function(){Upfront.Application.cssEditor.init({model:this.model,type:this.model.is_main()?"RegionContainer":"lightbox"==this.model.get("type")?"RegionLightbox":"Region",element_id:this.model.is_main()?"region-container-"+this.model.get("name"):"region-"+this.model.get("name")}),this.listenTo(Upfront.Application.cssEditor,"updateStyles",this.adjust_grid_padding)},adjust_grid_padding:function(){var e=new Upfront.Views.Editor.Command_ToggleGrid;e.update_grid()}})})}(jQuery);