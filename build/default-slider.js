(function(e){e.fn.upfront_default_slider=function(t){var n={auto:!0,interval:5e3,auto_height:!0,control:"outside",control_num:!0,control_next_prev:!0,show_control:"always",effect:"crossfade",classname:{slider:"upfront-default-slider",slider_wrap:"upfront-default-slider-wrap",item:"upfront-default-slider-item",nav:"upfront-default-slider-nav",nav_item:"upfront-default-slider-nav-item",prev:"upfront-default-slider-nav-prev",next:"upfront-default-slider-nav-next"}},r=this;e.extend(n,t),this.each(function(){function y(){t.removeClass(n.classname.slider+"-control-"+v),t.removeClass(n.classname.slider+"-control-"+m),h=t.attr("data-slider-auto"),typeof h!="string"?h=n.auto:h=h=="0"?!1:!0,p=t.attr("data-slider-interval")||n.interval,d=t.attr("data-slider-effect")||n.effect,v=t.attr("data-slider-control")||n.control,m=t.attr("data-slider-show-control")||n.show_control,t.addClass(n.classname.slider+"-control-"+v),t.addClass(n.classname.slider+"-control-"+m)}function b(e){i=e,s.html(""),s.append(i),i.addClass(n.classname.item),n.auto_height?(w(),t.find("img").one("load",w)):E()}function w(){t.css("height",9999),i.each(function(t){var n=e(this).find("img"),r=n.height();f=f>r?f:r}),t.css("height",Math.ceil(f/15)*15)}function E(){var n=t.outerHeight(),r=t.outerWidth();i.each(function(){var t=e(this).find("img"),i=t.height(),s=t.width();n/r>i/s?t.css({height:"100%",width:"auto"}):t.css({height:"auto",width:"100%"})})}function S(){o.html(""),n.control_num&&(i.each(function(e){o.append('<i class="'+n.classname.nav_item+'" data-slider-index="'+e+'">'+e+"</i>")}),t.on("click","."+n.classname.nav_item,function(t){t.preventDefault();var n=e(this).data("slider-index");x(n),c=!0}))}function x(r,s,u){var a=o.find("."+n.classname.nav_item).eq(r),f=i.eq(r),u=u?u:d,h=t.find("."+n.classname.item+"-current");!f.hasClass(n.classname.item+"-current")&&(!s||!c)&&(t.trigger("slideout",h),h.removeClass(n.classname.item+"-current"),f.addClass(n.classname.item+"-current"),o.find("."+n.classname.nav_item+"-selected").removeClass(n.classname.nav_item+"-selected"),a.addClass(n.classname.nav_item+"-selected"),l=r,f.addClass(n.classname.item+"-effect-"+u),f.one("animationend webkitAnimationEnd MSAnimationEnd oAnimationEnd webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend",function(){e(this).removeClass(n.classname.item+"-effect-"+u),f.hasClass(n.classname.item+"-current")&&t.trigger("slidein",f)})),c=!1}function T(){g&&clearInterval(g),h&&p>999&&(g=setInterval(function(){x(l+1>=i.length?0:l+1,!0)},p))}var t=e(this),i=n.item?t.find(">"+n.item):t.find(">."+n.classname.item),s=e('<div class="'+n.classname.slider_wrap+'" />'),o=e('<div class="'+n.classname.nav+'" />'),u=e('<div class="'+n.classname.prev+'" />'),a=e('<div class="'+n.classname.next+'" />'),f=0,l=0,c=!1,h,p,d,v,m,g;if(t.data("slider-applied"))return;t.data("slider-applied",!0),t.addClass(n.classname.slider),t.append(s),y(),b(i),n.auto_height||(e(window).on("load",E),e(window).on("resize",E)),S(),t.append(o),n.control_next_prev&&(t.append(u),t.on("click","."+n.classname.prev,function(e){e.preventDefault();var t=d=="slide-left"||d=="slide-right"?"slide-right":d=="crossfade"?"crossfade":"slide-down";x(l>0?l-1:i.length-1,!1,t),c=!0}),t.append(a),t.on("click","."+n.classname.next,function(e){e.preventDefault();var t=d=="slide-left"||d=="slide-right"?"slide-left":d=="crossfade"?"crossfade":"slide-up";x(l+1>=i.length?0:l+1,!1,t),c=!0})),x(0),T(),r.on("refresh",function(){var e=n.item?t.find(">"+n.item):t.find(">."+n.classname.item),r=e.length,s=i.length;y(),T(),r&&(b(e),S(),r!=s&&x(0)),n.auto_height||(E(),i.find("img").one("load",E))}),r.on("pause",function(){clearInterval(g)}),r.on("resume",function(){T()})})},e(document).ready(function(){var t={item:".upfront-inserted_image-wrapper",control_next_prev:!1};e(".upfront-inline_post-slider").upfront_default_slider(t);var n={auto_height:!1,control:"inside"};e(".upfront-bg-slider").upfront_default_slider(n),e(document).on("upfront-load",function(){Upfront.Events.on("application:mode:after_switch",function(){e(".upfront-inline_post-slider").upfront_default_slider(t)}),Upfront.Events.on("entity:background:update",function(e,t){var r=e.$el.find(".upfront-region-bg-slider");r.length&&(r.data("slider-applied")?r.trigger("refresh"):r.upfront_default_slider(n))})})})})(jQuery);